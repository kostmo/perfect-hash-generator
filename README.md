Original implementation found here:

http://stevehanov.ca/blog/index.php?id=119
